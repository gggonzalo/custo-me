<div class="flex flex-col h-screen h-[100dvh] max-w-7xl mx-auto p-2">
  <img src="assets/svg/logo.svg" alt="" class="h-14 md:h-20 mb-5" />
  <!-- 
    Changing minimum height of a flex container from the default 'auto' to 0.
    auto does not allow a flex container to become smaller that its contents. Allowing it to become smaller could be useful if we want to add scrollbars if the content exceeds the size of a container
    Width has the same behavior
  -->
  <div class="flex md:hidden mb-5">
    <button
      type="button"
      class="grow flex items-center justify-center transition bg-purple-700 enabled:hover:bg-purple-800 text-white border-2 border-purple-100 rounded-xl p-2"
      (click)="handleFiltersFormOpen()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="66.58"
        height="57.184"
        viewBox="0 0 66.58 57.184"
        class="fill-white h-5 w-5 mr-2"
      >
        <path
          d="M-170.816-274.868q7.167,0,14.334,0c1.011,0,2.023.02,3.032-.024.527-.023,1.044.071,1.571.034.56-.04,1.125-.009,1.688-.009h5.025c.667,0,.647-.008.877-.624a8.861,8.861,0,0,1,7.527-6.133,9,9,0,0,1,9.806,6.368.461.461,0,0,0,.519.393c1.524-.011,3.048.006,4.572-.011.387,0,.536.109.529.512q-.031,1.771,0,3.542c.007.409-.151.512-.532.508-1.455-.016-2.911.009-4.366-.014a.683.683,0,0,0-.79.553,9.08,9.08,0,0,1-8.732,6.294,9.07,9.07,0,0,1-8.531-6.292.687.687,0,0,0-.785-.557q-20.966.016-41.932.009a3.9,3.9,0,0,0-.412,0c-.349.037-.48-.083-.473-.459.024-1.235.019-2.471,0-3.707,0-.309.076-.394.39-.393Q-179.158-274.861-170.816-274.868Zm39.725,2.284a4.573,4.573,0,0,0-4.529-4.585,4.615,4.615,0,0,0-4.608,4.551,4.578,4.578,0,0,0,4.533,4.589A4.563,4.563,0,0,0-131.091-272.583Z"
          transform="translate(187.916 301.197)"
        />
        <path
          d="M-136.028-34.24c-4.64,0-9.281.006-13.921-.008a.636.636,0,0,0-.723.517,8.825,8.825,0,0,1-6.667,6.088,8.747,8.747,0,0,1-8.4-2.412,8.587,8.587,0,0,1-2.277-3.753.533.533,0,0,0-.615-.437q-6.013.013-12.026.005c-2.292,0-4.585-.007-6.877.006-.363,0-.5-.083-.494-.48.023-1.235.014-2.471-.012-3.706-.008-.364.192-.366.44-.366h9.761c3.031,0,6.062-.006,9.093.009a.67.67,0,0,0,.764-.53,8.843,8.843,0,0,1,7.366-6.208,8.7,8.7,0,0,1,7.288,2.177,8.784,8.784,0,0,1,2.684,4.156c.113.367.343.4.653.4q3.913-.007,7.825,0h19.852c.927,0,.831-.042.832.812q0,1.524,0,3.048c0,.686,0,.686-.667.686Zm-23.343,2.291a4.58,4.58,0,0,0,4.619-4.534,4.613,4.613,0,0,0-4.525-4.6,4.589,4.589,0,0,0-4.635,4.484A4.57,4.57,0,0,0-159.371-31.949Z"
          transform="translate(188.054 84.575)"
        />
        <path
          d="M-141.742-506.927h-17.875c-.59,0-1.181.019-1.77-.006a.515.515,0,0,0-.583.439,9.022,9.022,0,0,1-3.236,4.6,8.926,8.926,0,0,1-4.538,1.782,8.741,8.741,0,0,1-4.73-.795,8.915,8.915,0,0,1-4.838-5.485.667.667,0,0,0-.777-.548c-2.553.019-5.107,0-7.661.02-.388,0-.442-.117-.438-.462q.022-1.914-.021-3.829c-.007-.31.17-.219.313-.219,2.595,0,5.19-.011,7.784.013a.706.706,0,0,0,.808-.573,8.9,8.9,0,0,1,7.664-6.237,8.479,8.479,0,0,1,5.544,1.167,8.936,8.936,0,0,1,4.078,5.07.716.716,0,0,0,.825.572q19.358-.018,38.716-.009a3.175,3.175,0,0,0,.37,0c.362-.042.48.113.475.471q-.024,1.812,0,3.624c0,.328-.1.414-.426.413q-6.692-.017-13.384-.009Zm-24.341-2.226a4.636,4.636,0,0,0-4.61-4.613,4.584,4.584,0,0,0-4.522,4.6,4.559,4.559,0,0,0,4.57,4.583A4.62,4.62,0,0,0-166.083-509.153Z"
          transform="translate(188.209 518.3)"
        />
      </svg>
      <span class="text-white">Filters</span>
    </button>
  </div>
  <div class="grow flex items-start gap-3 min-h-0">
    <ng-container
      *ngIf="{
        filters: getFiltersTask$ | async,
        characters: getCharactersTask | async
      } as homePageData"
    >
      <ng-container *ngIf="homePageData.filters && homePageData.characters">
        <div
          class="md:animate-slide-from-left absolute top-0 right-0 bottom-0 left-0 md:static md:shrink-0 md:max-w-[25%] md:h-full z-10 md:block"
          [ngClass]="filtersFormIsOpen ? 'block' : 'hidden'"
        >
          <app-filters-form
            [filters]="homePageData.filters"
            [formContainerClasses]="[
              'bg-purple-100',
              'text-purple-700',
              'md:rounded-xl',
              'h-full md:h-auto',
              'md:max-h-full'
            ]"
            [isClosable]="true"
            [closeButtonClasses]="['block md:hidden']"
            (onFiltersSelected)="handleFiltersSelected($event)"
            (onClose)="handleFiltersFormClose()"
          ></app-filters-form>
        </div>
        <div
          class="animate-fade-in md:animate-wait-then-fade-in grow flex items-start h-full overflow-auto"
        >
          <div
            *ngIf="charactersLoading"
            class="flex items-center text-white mx-auto"
          >
            <svg
              class="animate-spin h-8 w-8 mr-3"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
              ></path>
            </svg>
            <span class="text-xl">Loading characters...</span>
          </div>
          <ng-container *ngIf="!charactersLoading">
            <div
              *ngIf="homePageData.characters.length > 0; else noCharacters"
              class="grow grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2"
            >
              <character-card
                *ngFor="let character of homePageData.characters"
                [character]="character"
              ></character-card>
            </div>
            <ng-template #noCharacters>
              <div class="flex items-center text-white mx-auto">
                <svg
                  version="1.1"
                  id="Capa_1"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  viewBox="0 0 106.059 106.059"
                  xml:space="preserve"
                  class="mr-3 h-8 w-8 fill-white"
                >
                  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                  <g
                    id="SVGRepo_tracerCarrier"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></g>
                  <g id="SVGRepo_iconCarrier">
                    <g>
                      <path
                        d="M90.546,15.518C69.858-5.172,36.199-5.172,15.515,15.513C-5.173,36.198-5.171,69.858,15.517,90.547 c20.682,20.684,54.341,20.684,75.027-0.004C111.23,69.858,111.229,36.2,90.546,15.518z M84.757,84.758 c-17.494,17.494-45.96,17.496-63.455,0.002c-17.498-17.497-17.496-45.966,0-63.46C38.796,3.807,67.261,3.805,84.759,21.302 C102.253,38.796,102.251,67.265,84.757,84.758z M77.017,74.001c0.658,1.521-0.042,3.286-1.562,3.943 c-1.521,0.66-3.286-0.042-3.944-1.562c-2.893-6.689-9.73-11.012-17.421-11.012c-7.868,0-14.747,4.319-17.522,11.004 c-0.479,1.154-1.596,1.851-2.771,1.851c-0.384,0-0.773-0.074-1.15-0.23c-1.53-0.636-2.255-2.392-1.62-3.921 c3.71-8.932,12.764-14.703,23.063-14.703C64.174,59.371,73.174,65.113,77.017,74.001z M33.24,38.671 c0-3.424,2.777-6.201,6.201-6.201c3.423,0,6.2,2.776,6.2,6.201c0,3.426-2.777,6.202-6.2,6.202 C36.017,44.873,33.24,42.097,33.24,38.671z M61.357,38.671c0-3.424,2.779-6.201,6.203-6.201c3.423,0,6.2,2.776,6.2,6.201 c0,3.426-2.776,6.202-6.2,6.202S61.357,42.097,61.357,38.671z"
                      ></path>
                    </g>
                  </g>
                </svg>
                <span class="text-xl">No characters found</span>
              </div>
            </ng-template>
          </ng-container>
        </div>
      </ng-container>
      <ng-container *ngIf="!(homePageData.filters && homePageData.characters)">
        <div class="flex items-center text-white mx-auto">
          <svg
            class="animate-spin h-8 w-8 fill-white mr-3"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
          >
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
            ></path>
          </svg>
          <span class="text-xl">Loading data...</span>
        </div>
      </ng-container>
    </ng-container>
  </div>
</div>
