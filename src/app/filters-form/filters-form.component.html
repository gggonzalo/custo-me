<!-- TODO: Add responsive rounded borders -->
<form
  [formGroup]="filtersForm"
  (ngSubmit)="handleFiltersFormSubmit()"
  class="flex flex-col max-h-full bg-purple-50 text-purple-700 rounded-xl"
>
  <div
    class="flex items-center justify-between border-b-2 border-b-purple-200 p-2"
  >
    <p class="text-2xl">Filters</p>
    <div class="group relative flex">
      <button type="button" class="self-center">
        <svg
          viewBox="0 0 48 48"
          xmlns="http://www.w3.org/2000/svg"
          class="w-6 h-6 fill-purple-700"
        >
          <path d="M0 0h48v48H0z" fill="none" />
          <g id="Shopicon">
            <circle cx="24" cy="24" r="5" />
            <circle cx="24" cy="11" r="5" />
            <circle cx="24" cy="37" r="5" />
          </g>
        </svg>
      </button>
      <div
        formGroupName="filteringOptions"
        class="absolute invisible opacity-0 translate-y-6 group-hover:visible group-hover:opacity-100 flex flex-col bg-purple-50 border-2 border-purple-200 rounded-xl z-10"
      >
        <div class="p-2">
          <app-checkbox
            [groupPath]="['filteringOptions']"
            controlName="mutuallyInclusiveFilters"
          >
            <p class="checkbox-label w-max">Mutually inclusive filters</p>
          </app-checkbox>
        </div>
      </div>
    </div>
  </div>
  <div
    formGroupName="filtersSelection"
    class="grow flex flex-col overflow-y-auto p-2"
  >
    <div *ngFor="let filter of filters" class="mb-5">
      <p class="text-lg font-medium mb-2">{{ filter.name }}</p>
      <div class="flex flex-col items-start gap-y-0.5">
        <app-checkbox
          *ngFor="let option of filter.options"
          [groupPath]="['filtersSelection', filter.name]"
          [controlName]="option.name"
        >
          <p class="checkbox-label">
            {{ option.name }}&nbsp;<span class="font-light"
              >({{ option.count }})</span
            >
          </p>
        </app-checkbox>
      </div>
    </div>
  </div>
  <div class="flex border-t-2 border-t-purple-200 p-2">
    <button
      class="grow transition bg-purple-600 enabled:hover:bg-purple-700 disabled:opacity-75 text-center text-white rounded-xl p-2"
      type="submit"
      [disabled]="!(canSubmitFormCheckTask | async)"
    >
      Apply
    </button>
  </div>
</form>
